<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="utf-8"></meta>
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"></meta>
   <title>活动列表</title>
      <!-- JQUERY-->
   <script src="/admin/vendor/jquery/dist/jquery.js"></script>
   <!-- FONT AWESOME-->
   <link rel="stylesheet" href="/admin/vendor/fontawesome/css/font-awesome.min.css"></link>
   <!-- SIMPLE LINE ICONS-->
   <link rel="stylesheet" href="/admin/vendor/simple-line-icons/css/simple-line-icons.css"></link>
   <!-- WHIRL (spinners)-->
   <link rel="stylesheet" href="/admin/vendor/whirl/dist/whirl.css"></link>
   <!-- =============== PAGE VENDOR STYLES ===============-->
      <!-- DATATABLES-->
   <link rel="stylesheet" href="/admin/vendor/datatables-colvis/css/dataTables.colVis.css"></link>
   <link rel="stylesheet" href="/admin/vendor/datatable-bootstrap/css/dataTables.bootstrap.css"></link>
   <!-- =============== BOOTSTRAP STYLES ===============-->
   <link rel="stylesheet" href="/admin/css/bootstrap.css" id="bscss"></link>
   <!-- =============== APP STYLES ===============-->
   <link rel="stylesheet" href="/admin/css/app.css" id="maincss"></link>
</head>

<body>
   <div class="wrapper">
      <!-- top navbar-->
      <header class="topnavbar-wrapper">
         <!-- START Top Navbar-->
         <nav role="navigation" class="navbar topnavbar">
            <!-- START navbar header-->
            <div class="navbar-header">
               <a href="/admin/index" class="navbar-brand">
                  <div class="brand-logo">
                     <img src="/admin/img/logo.png" alt="App Logo" class="img-responsive"></img>
                  </div>
                  <div class="brand-logo-collapsed">
                     <img src="/admin/img/logo-single.png" alt="App Logo" class="img-responsive"></img>
                  </div>
               </a>
            </div>
            <!-- END navbar header-->
            <!-- START Nav wrapper-->
            <div class="nav-wrapper">
               <!-- START Left navbar-->
               <ul class="nav navbar-nav">
                  <li>
                     <!-- Button used to collapse the left sidebar. Only visible on tablet and desktops-->
                     <a href="#" data-toggle-state="aside-collapsed" class="hidden-xs">
                        <em class="fa fa-navicon"></em>
                     </a>
                     <!-- Button to show/hide the sidebar on mobile. Visible on mobile only.-->
                     <a href="#" data-toggle-state="aside-toggled" data-no-persist="true" class="visible-xs sidebar-toggle">
                        <em class="fa fa-navicon"></em>
                     </a>
                  </li>
               </ul>
               <!-- END Left navbar-->
               
            </div>
            <!-- END Nav wrapper-->
            
         </nav>
         <!-- END Top Navbar-->
      </header>
      <!-- sidebar-->
      <aside class="aside">
         <!-- START Sidebar (left)-->
         <div class="aside-inner">
            <nav class="sidebar">
               <!-- START sidebar nav-->
               <ul class="nav">
                  <!-- Iterates over all sidebar items-->
                  <li class="nav-heading ">
                     <span data-localize="sidebar.heading.HEADER"></span>
                  </li>
                 
                  <li class=" ">
                     <a href="#menuid" title="活动" data-toggle="collapse">
                        <em class="icon-folder"></em>
                        <span data-localize="sidebar.nav.menu.MENU">活动</span>
                     </a>
                     <ul id="menuid" class="nav sidebar-subnav collapse">
                        <li class="sidebar-subnav-header">活动</li>
                        <li class=" active">
                           <a href="/admin/activity/index.html" title="活动列表">
                              <em></em>
                              <span data-localize="sidebar.nav.menu.SUBMENU">活动列表</span>
                           </a>
                        </li>
                     </ul>
                  </li>
                  
                  <li class=" ">
                     <a href="#order" title="订单" data-toggle="collapse">
                        <em class="icon-folder"></em>
                        <span data-localize="sidebar.nav.menu.MENU">订单</span>
                     </a>
                     <ul id="order" class="nav sidebar-subnav collapse">
                        <li class="sidebar-subnav-header">订单</li>
                        <li class=" ">
                           <a href="/admin/order/index.html" title="订单">
                              <em></em>
                              <span data-localize="sidebar.nav.menu.SUBMENU">订单列表</span>
                           </a>
                        </li>
                     </ul>
                  </li>
                  
                  <li class=" ">
                     <a href="#transfer" title="转账" data-toggle="collapse">
                        <em class="icon-folder"></em>
                        <span data-localize="sidebar.nav.menu.MENU">转账</span>
                     </a>
                     <ul id="transfer" class="nav sidebar-subnav collapse">
                        <li class="sidebar-subnav-header">转账</li>
                        <li class=" ">
                           <a href="/admin/transfer/index.html" title="转账">
                              <em></em>
                              <span data-localize="sidebar.nav.menu.SUBMENU">转账列表</span>
                           </a>
                        </li>
                     </ul>
                  </li>
                  
                  <li class=" ">
                     <a href="#contact" title="联系人" data-toggle="collapse">
                        <em class="icon-folder"></em>
                        <span data-localize="sidebar.nav.menu.MENU">联系人</span>
                     </a>
                     <ul id="contact" class="nav sidebar-subnav collapse">
                        <li class="sidebar-subnav-header">联系人</li>
                        <li class=" ">
                           <a href="/admin/contact/index.html" title="联系人">
                              <em></em>
                              <span data-localize="sidebar.nav.menu.SUBMENU">联系人列表</span>
                           </a>
                        </li>
                     </ul>
                  </li>
                  
               </ul>
               <!-- END sidebar nav-->
            </nav>
         </div>
         <!-- END Sidebar (left)-->
      </aside>
      
      <section>
         <!-- Page content-->
         <div class="content-wrapper">
         
         	<h3>活动列表</h3>
            <div class="row">
            
               <div class="col-lg-12">
                     <div class="panel panel-default">
                        <div class="panel-body">
                           <table id="datatable1" class="table table-striped table-hover">
                              <thead>
                              	<tr>
	                              <th>
			                        <div class="form-group">
			                           <button type="button" data-toggle="modal" data-target="#myModalLarge" class="btn btn-labeled btn-success btn_add">
			                              <span class="btn-label">
			                                 <em class="fa fa-plus"></em>
			                              </span>Add</button>
			                        </div>
	                     		  </th>
                              	</tr>
                                 <tr>
                                    <th>ID</th>
                                    <th>活动名称</th>
                                    <th>商户名称</th>
                                    <th>报名金额</th>
                                    <th>分享金额</th>
                                    <th>开始时间</th>
                                    <th>结束时间</th>
                                    <th>参与人数</th>
                                    <th>活动链接</th>
                                    <th>操作</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr th:each="m : ${actList}">
                                    <td th:text="${m.id}"></td>
                                    <td th:text="${m.name}"></td>
                                    <td th:text="${m.merchant}"></td>
                                    <td th:text="${m.amount}"></td>
                                    <td th:text="${m.shareAmount}"></td>
                                    <td th:text="${#dates.format(m.startTime,'yyyy-MM-dd HH:mm:ss')}"></td>
                                    <td th:text="${#dates.format(m.endTime,'yyyy-MM-dd HH:mm:ss')}"></td>
                                    <td th:text="${m.joinCount}"></td>
                                    <td th:text="${m.actUrl}"></td>
                                    <td>
				                        <button type="button" data-toggle="modal" data-target="#myModalLarge"  class="btn btn-sm btn-warning btn_update">
				                           <em class="fa fa-edit"></em>
				                        </button>
				                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </div>
                  </div>
               
            </div>
         </div>
      </section>
      
      <!-- Page footer-->
      <footer>
         <span>&copy; 2019 - 保定泰高广告有限公司</span>
      </footer>
   </div>
   <!-- =============== VENDOR SCRIPTS ===============-->
   <!-- MODERNIZR-->
   <script src="/admin/vendor/modernizr/modernizr.js"></script>
   <!-- BOOTSTRAP-->
   <script src="/admin/vendor/bootstrap/dist/js/bootstrap.js"></script>
   <!-- STORAGE API-->
   <script src="/admin/vendor/jQuery-Storage-API/jquery.storageapi.js"></script>
   <!-- JQUERY EASING-->
   <script src="/admin/vendor/jquery.easing/js/jquery.easing.js"></script>
   <!-- ANIMO-->
   <script src="/admin/vendor/animo.js/animo.js"></script>

   <!-- =============== PAGE VENDOR SCRIPTS ===============-->
   <!-- DATATABLES-->
   <script src="/admin/vendor/datatables/media/js/jquery.dataTables.min.js"></script>
   <script src="/admin/vendor/datatables-colvis/js/dataTables.colVis.js"></script>
   <script src="/admin/vendor/datatable-bootstrap/js/dataTables.bootstrap.js"></script>
   <script src="/admin/vendor/datatable-bootstrap/js/dataTables.bootstrapPagination.js"></script>
   <script src="/admin/My97DatePicker/WdatePicker.js"></script>
   <script src="/admin/js/demo-datatable.js"></script>
   <!-- =============== APP SCRIPTS ===============-->
   
   <!-- Modal Large-->
   <div id="myModalLarge" tabindex="-1" role="dialog" aria-labelledby="myModalLabelLarge" aria-hidden="true" class="modal fade">
      <div class="modal-dialog modal-lg">
         <div class="modal-content">
            <div class="modal-header">
               <button type="button" data-dismiss="modal" aria-label="Close" class="close">
                  <span aria-hidden="true">&times;</span>
               </button>
               <h4 id="myModalLabelLarge" class="modal-title">活动</h4>
            </div>
            <form class="form-horizontal" action="/admin/activity/save" method="post" id="formAct">
            	<input id="actId" name="id" type="hidden"></input>
            	<div class="modal-body">
                     <div class="form-group">
                        <label class="col-lg-2 control-label">活动名称*</label>
                        <div class="col-lg-3">
                           <input type="text" name="name" required="required" placeholder="活动名称" class="form-control"></input>
                        </div>
                        <label class="col-lg-2 control-label">商户名称*</label>
                        <div class="col-lg-3">
                           <input type="text" name="merchant" required="required" placeholder="商户名称" class="form-control"></input>
                        </div>
                     </div>
                     <div class="form-group">
                        <label class="col-lg-2 control-label">开始时间*</label>
                        <div class="col-lg-3">
                           <input type="text" name="startTime" required="required" placeholder="开始时间" class="form-control" onclick="WdatePicker({dateFmt: 'yyyy-MM-dd HH:mm:ss',isShowClear:false,readOnly:true})"></input>
                        </div>
                        <label class="col-lg-2 control-label">结束时间*</label>
                        <div class="col-lg-3">
                           <input type="text" name="endTime" required="required" placeholder="结束时间" class="form-control" onclick="WdatePicker({dateFmt: 'yyyy-MM-dd HH:mm:ss',isShowClear:false,readOnly:true})"></input>
                        </div>
                     </div>

                     <div class="form-group">
                        <label class="col-lg-2 control-label">活动金额*</label>
                        <div class="col-lg-3">
                           <input type="text" name="amount" required="required"  placeholder="整数或小数"  class="form-control"></input>
                        </div>
                        <label class="col-lg-2 control-label">分享金额*</label>
                        <div class="col-lg-3">
                           <input type="text" name="shareAmount" required="required"  placeholder="整数或小数" class="form-control"></input>
                        </div>
                     </div>

                     
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">首页图片*</label>
                        <div class="col-lg-4">
                        	<input type="text" name="firstImg"  required="required" class="form-control"></input>
                        </div>
                        <div class="col-lg-4">
                        	<input type="file"  id="save_file_first" class="form-control"></input>
                        </div>
                        <div class="col-lg-1">
                        	<button type="button" class="btn btn-success btn_first">上传</button>
                        </div>
                     </div>
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">商品图片*</label>
                        <div class="col-lg-4">
                        	<input type="text" name="infoImg"  required="required" class="form-control"></input>
                        </div>
                        <div class="col-lg-4">
                        	<input type="file"  id="save_file_info" class="form-control"></input>
                        </div>
                        <div class="col-lg-1">
                        	<button type="button" class="btn btn-success btn_info">上传</button>
                        </div>
                     </div>
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">分享图片*</label>
                        <div class="col-lg-4">
                        	<input type="text" name="shareImg"  required="required" class="form-control"></input>
                        </div>
                        <div class="col-lg-4">
                        	<input type="file"  id="save_file_share" class="form-control"></input>
                        </div>
                        <div class="col-lg-1">
                        	<button type="button" class="btn btn-success btn_share">上传</button>
                        </div>
                     </div>
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">限制人数</label>
                        <div class="col-lg-8">
                           <input type="number" name="limitCount" placeholder="最多参加人数" class="form-control"></input>
                        </div>
                     </div>
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">技术支持</label>
                        <div class="col-lg-8">
                        	<textarea name="techInfo" class="form-control" placeholder="技术支持：河北辰祥广告传媒 创建活动：19933395887" ></textarea>
                        </div>
                     </div>
                     
                     <HR align='center' width='90%' SIZE='1'></HR>
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">分享标题*</label>
                        <div class="col-lg-3">
                           <input type="text" name="shareTitle" required="required"  placeholder="微信分享标题"  class="form-control"></input>
                        </div>
                     </div>
                     
                     <div class="form-group">
                     	<label class="col-lg-2 control-label">分享描述*</label>
                        <div class="col-lg-8">
                        	<input type="text" name="shareDesc" required="required"  placeholder="微信分享描述"  class="form-control"></input>
                        </div>
                     </div>
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">分享图标*</label>
                        <div class="col-lg-4">
                        	<input type="text" name="shareSmallImg"  required="required" class="form-control"></input>
                        </div>
                        <div class="col-lg-4">
                        	<input type="file"  id="save_file_share_small" class="form-control"></input>
                        </div>
                        <div class="col-lg-1">
                        	<button type="button" class="btn btn-success btn_share_small">上传</button>
                        </div>
                     </div>
                     
                     <HR align='center' width='90%'  SIZE='1'></HR>
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">背景音乐*</label>
                        <div class="col-lg-4">
                        	<input type="text" name="music"  required="required" class="form-control"></input>
                        </div>
                        <div class="col-lg-4">
                        	<input type="file"  id="save_file_music" class="form-control"></input>
                        </div>
                        <div class="col-lg-1">
                        	<button type="button" class="btn btn-success btn_music">上传</button>
                        </div>
                     </div>
                     
                     <div class="form-group">
                        <label class="col-lg-2 control-label">客服二维码*</label>
                        <div class="col-lg-4">
                        	<input type="text" name="callQr"  required="required" class="form-control"></input>
                        </div>
                        <div class="col-lg-4">
                        	<input type="file"  id="save_file_callQr" class="form-control"></input>
                        </div>
                        <div class="col-lg-1">
                        	<button type="button" class="btn btn-success btn_callQr">上传</button>
                        </div>
                     </div>
                     
                     
                     
            	</div>
	            <div class="modal-footer">
               		<button type="reset"  class="btn btn-default btn_reset">Reset</button>
               		<button type="submit" class="btn btn-primary">Save</button>
	            </div>
            </form>
         </div>
      </div>
   </div>
   
   
   <script type="text/javascript">
   
   $(".btn_add").click(function(){
	   $("#formAct")[0].reset();
	   $(".btn_reset").attr("disabled",false);
   });
   
   
   	$(".btn_update").click(function(){
   		$(".btn_reset").attr("disabled",true);
	   var actId = $(this).parent("td").siblings().html();
	   $.ajax({
		    url: "/admin/activity/get",
		    type: "get",
		    data: {"actId":actId},
		    dataType: 'json',
		    success: function(result){
		    	console.log(result);
		    	$("input[name='id']").val(result.id);
		    	$("input[name='name']").val(result.name);
		    	$("input[name='merchant']").val(result.merchant);
		    	$("input[name='startTime']").val(result.startTime);
		    	$("input[name='endTime']").val(result.endTime);
		    	$("input[name='amount']").val(result.amount);
		    	$("input[name='shareAmount']").val(result.shareAmount);
		    	$("input[name='limitCount']").val(result.limitCount);
		    	$("input[name='firstImg']").val(result.firstImg);
		    	$("input[name='infoImg']").val(result.infoImg);
		    	$("input[name='shareImg']").val(result.shareImg);
		    	$("textarea[name='techInfo']").val(result.techInfo);
		    	$("input[name='shareTitle']").val(result.shareTitle);
		    	$("input[name='shareDesc']").val(result.shareDesc);
		    	$("input[name='shareSmallImg']").val(result.shareSmallImg);
		    	$("input[name='music']").val(result.music);
		    	$("input[name='callQr']").val(result.callQr);
		    }
		});
	});
   	
   	$(".btn_first").click(function(){
   		var formData = new FormData();
   		var file = document.getElementById("save_file_first").files[0];
   		formData.append('file', file);
   		$("input[name='firstImg']").val(upload(formData).url);
 	});
   	
   	$(".btn_info").click(function(){
   		var formData = new FormData();
   		var file = document.getElementById("save_file_info").files[0];
   		formData.append('file', file);
   		$("input[name='infoImg']").val(upload(formData).url);
 	});
   	
   	$(".btn_share").click(function(){
   		var formData = new FormData();
   		var file = document.getElementById("save_file_share").files[0];
   		formData.append('file', file);
        $("input[name='shareImg']").val(upload(formData).url);
 	});
   	
   	$(".btn_share_small").click(function(){
   		var formData = new FormData();
   		var file = document.getElementById("save_file_share_small").files[0];
   		formData.append('file', file);
        $("input[name='shareSmallImg']").val(upload(formData).url);
 	});
   	
   	$(".btn_music").click(function(){
   		var formData = new FormData();
   		var file = document.getElementById("save_file_music").files[0];
   		formData.append('file', file);
        $("input[name='music']").val(upload(formData).url);
 	});
   	
   	$(".btn_callQr").click(function(){
   		var formData = new FormData();
   		var file = document.getElementById("save_file_callQr").files[0];
   		formData.append('file', file);
        $("input[name='callQr']").val(upload(formData).url);
 	});
   	
   	//上
   	function upload(formData){
    	var value; 
   		$.ajax({
   			async:false,
            url: "/component/upload",
            type: "post",
            data: formData,
            contentType: false,
            processData: false,
            mimeType: "multipart/form-data",
            success: function (data) {
         	 	value =  jQuery.parseJSON(data);
         	   	if(value.code == "true"){
         	   	}else{
         	   		console.log(value.msg);
         	   	}
            }
        });
   		return value;
   	}
   	
   	
   
   </script>
   
   <script src="/admin/js/app.js"></script>
</body>

</html>